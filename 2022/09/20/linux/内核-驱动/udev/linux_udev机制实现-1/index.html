<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">

	<!-- title -->
	
	<title>
	
		linux_udev机制实现-1 |
	
	Sisyphus
	</title>

	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.png">
	


	<!-- search -->
	<script>
		var searchEngine = "";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.27.0/themes/prism.min.css">

	
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.27.0/plugins/line-numbers/prism-line-numbers.min.css">



	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>


	<!-- Mermaid JS -->
	<script src="https://cdn.jsdelivr.net/npm/mermaid@10.9/dist/mermaid.min.js"></script>
	<!-- D3.js -->
	<script src="https://d3js.org/d3.v6.min.js"></script>

	<script>
		// Define the function globally
		(function(d3) {
		function initializeZoom(d3) {
				// Apply the zoom behavior to each SVG
				document.querySelectorAll("pre.mermaid svg").forEach(svg => {
				const zoomBehavior = d3.zoom().on("zoom", (event) => {
					d3.select(svg).select('g').attr("transform", event.transform);
				});
				d3.select(svg).call(zoomBehavior).on("dblclick.zoom", null);
				});
			console.log('Zoom initialized.');
		}

		document.addEventListener('DOMContentLoaded', function() {
			mermaid.initialize({ startOnLoad: true, theme: 'forest' });

			// Polling for SVG rendering
			const checkRender = setInterval(() => {
				if (document.querySelector("pre.mermaid svg")) {
					clearInterval(checkRender);
					// Pass the d3 object to initializeZoom
					initializeZoom(d3);
				}
			}, 300); // Check every 300 milliseconds
		});
		})(window.d3);
	</script>


	
	

<meta name="generator" content="Hexo 7.3.0"></head>


<body>
	<header id="header">
    <a id="title" href="/" class="logo">Sisyphus</a>

	<ul id="menu">
    

    
      <li class="menu-item">
        <a href="/tags" class="menu-item-link">标签</a>
      </li>
    

    
      <li class="menu-item">
        <a href="/categories" class="menu-item-link">分类</a>
      </li>
    

    
  
    
      <li class="menu-item">
        <a href='https://github.com/sisyphus1212' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="按回车全站搜索">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										DOCA
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/DOCA/virtio-net-controller/">
                     
										    virtio-net-controller
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/DOCA/%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">
                     
										    基本操作
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										dpdk
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/21/dpdk/dpdk%20vhost_user%E5%8D%8F%E8%AE%AE/">
                     
										    vhost_user协议
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/dpdk/dpdk_iova/">
                     
										    dpdk_iova
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/dpdk/dpdk_legacy_memory/">
                     
										    dpdk_legacy_memory
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/03/19/dpdk/dpdk_mbuf_%E7%BB%93%E6%9E%84/">
                     
										    dpdk mbuf 结构
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/dpdk/dpdk_memzone_mpool_mbuf%E5%85%B3%E7%B3%BB%E6%A2%B3%E7%90%86/">
                     
										    dpdk_memzone_mpool_mbuf关系梳理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/03/19/dpdk/dpdk_vdpa%E7%83%AD%E8%BF%81%E7%A7%BB-%E8%84%8F%E9%A1%B5%E6%A0%87%E8%AE%B0/">
                     
										    dpdk_vdpa热迁移-脏页标记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/21/dpdk/dpdk%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">
                     
										    dpdk 内存管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/21/dpdk/dpdk%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/">
                     
										    dpdk测试用例
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/03/19/dpdk/dpdk%E7%BC%96%E8%AF%91/">
                     
										    dpdk 编译
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/03/19/dpdk/dpdk%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%88%9D%E5%A7%8B%E5%8C%96%E9%80%BB%E8%BE%91/">
                     
										    dpdk 编译
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/03/19/dpdk/testpmd%E4%BD%BF%E7%94%A8/">
                     
										    testpmd使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/21/dpdk/vhost_user_virtio_net%E5%90%8E%E7%AB%AF%E9%80%BB%E8%BE%91/">
                     
										    dpdk 编译
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										github
									</a>
									
							<ul>
								<li class="file">
									<a href="/2020/11/01/github/git%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
                     
										    git 常用命令
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										linux
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										内核-驱动
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										common
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/common/%E5%86%85%E6%A0%B8%E6%89%93%E5%8D%B0%E6%A0%BC%E5%BC%8F/">
                     
										    内核打印格式化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/11/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/common/%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/">
                     
										    驱动开发技巧
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										cpu
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/cpu/cpu%E4%B8%8A%E4%B8%8B%E7%BA%BF/">
                     
										    cpu上下线
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										dma
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/dma/gfp/">
                     
										    gfp
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/dma/iommu%E6%B5%81%E7%A8%8B/">
                     
										    iommu流程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/dma/scatterlist/">
                     
										    scatterlist
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										iommu
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/iommu/intel_iommu%E5%AF%84%E5%AD%98%E5%99%A8%E8%A7%84%E8%8C%83/">
                     
										    intel_iommu寄存器规范
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/iommu/iommu/">
                     
										    iommu
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/iommu/ioremap/">
                     
										    ioremap
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										napi
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/napi/napi/">
                     
										    napi
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/pcie/">
                     
										    pcie
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/pcie_hotplug/">
                     
										    pcie_hotplug
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/per_cpu/">
                     
										    per_cpu
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										udev
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/linux_udev%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-0/">
                     
										    linux_udev机制实现-0
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/linux_udev%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-1/">
                     
										    linux_udev机制实现-1
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/linux_udev%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-2/">
                     
										    linux_udev机制实现-2
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/linux_udev%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-3/">
                     
										    linux_udev机制实现-3
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/udev_rules%E7%AE%80%E4%BB%8B/">
                     
										    udev机制实现
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/uevent%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0/">
                     
										    uevent接口实现
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										virtio
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/virtio/virtio_net/">
                     
										    virtio_net
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										中断
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/armv8%E4%B8%AD%E6%96%AD%E7%8E%B0%E5%9C%BA%E4%BF%9D%E5%AD%98%E5%AF%84%E5%AD%98%E5%99%A8/">
                     
										    armv8中断现场保存寄存器
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/armv8%E8%AE%BE%E5%A4%87%E6%A0%91%E8%A7%A3%E6%9E%90/">
                     
										    armv8设备树解析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/msi_domain_alloc/">
                     
										    msi_domain_alloc
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/09/11/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E5%86%85%E6%A0%B8preempt/">
                     
										    内核preempt
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E6%89%93%E5%8D%B0%E5%86%85%E6%A0%B8%E5%87%BD%E6%95%B0%E5%A4%84%E4%BA%8E%E4%BB%80%E4%B9%88%E4%B8%8A%E4%B8%8B%E6%96%87/">
                     
										    打印内核函数处于什么上下文
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--allocated_irqs%E4%B8%8Eirq_desc%E6%95%B0%E7%BB%84%E5%A6%82%E4%BD%95%E5%8D%8F%E5%90%8C%E5%B7%A5%E4%BD%9C/">
                     
										    硬中断--allocated_irqs与irq_desc数组如何协同工作
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--apic/">
                     
										    硬中断--apic
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--asm_do_IRQ/">
                     
										    硬中断--asm_do_IRQ
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--ioapic/">
                     
										    硬中断--ioapic
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--irq_domain%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96/">
                     
										    硬中断--irq_domain的初始化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--irq_exit/">
                     
										    硬中断--irq_exit
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--irq_matrix%E7%BB%93%E6%9E%84%E4%BD%93/">
                     
										    硬中断--irq_matrix结构体
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--x86%E4%B8%AD%E6%96%AD%E5%88%9D%E5%A7%8B%E5%8C%96/">
                     
										    硬中断--x86中断初始化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--%E4%B8%AD%E6%96%AD%E5%8F%B7%E6%98%A0%E5%B0%84/">
                     
										    硬中断--中断号映射
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--%E5%88%9D%E5%A7%8B%E5%8C%96/">
                     
										    硬中断--初始化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
                     
										    硬中断--数据结构
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E7%A1%AC%E4%B8%AD%E6%96%AD--%E7%A1%AC%E4%B8%AD%E6%96%AD%E5%8F%B7%E7%9A%84%E8%A7%A3%E6%9E%90/">
                     
										    硬中断--硬中断号的解析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E8%BD%AF%E4%B8%AD%E6%96%AD--__do_softirq/">
                     
										    __do_softirq 分析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E8%BD%AF%E4%B8%AD%E6%96%AD--__raise_softirq/">
                     
										    __raise_softirq 分析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E8%BD%AF%E4%B8%AD%E6%96%AD--ksoftirqd/">
                     
										    ksoftirqd 分析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E8%BD%AF%E4%B8%AD%E6%96%AD--net_rx_action/">
                     
										    net_rx_action 分析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E8%BD%AF%E4%B8%AD%E6%96%AD--wakeup_softirqd/">
                     
										    软中断--wakeup_softirqd
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E8%BD%AF%E4%B8%AD%E6%96%AD--%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2%E6%8E%A5%E5%8F%A3/">
                     
										    软中断上下文切换接口
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/09/11/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%B8%AD%E6%96%AD/%E8%BD%AF%E4%B8%AD%E6%96%AD--%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%88%99/">
                     
										    软中断使用原则
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/11/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E4%BF%AE%E6%94%B9%E4%BB%BB%E6%84%8FLinux%E8%BF%9B%E7%A8%8B%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E5%AE%9E%E6%96%BD%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/">
                     
										    修改任意Linux进程地址空间实施代码注入
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										设备驱动
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/09/02/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8/linux%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8resource/">
                     
										    linux设备驱动resource
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										系统启动
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/11/20/linux/%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E7%9B%B8%E5%85%B3/">
                     
										    系统启动相关
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										系统基础
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/08/29/linux/%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/Linux%E4%B8%8B%E7%9A%84%E6%97%B6%E9%92%9F/">
                     
										    Linux下的时钟
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/20/linux/%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/ptp%E6%97%B6%E9%92%9F%E5%90%8C%E6%AD%A5%E4%BB%8B%E7%BB%8D/">
                     
										    ptp时钟同步介绍
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/08/linux/%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/ubuntu%E5%86%85%E6%A0%B8%E6%9E%84%E5%BB%BA/">
                     
										    ubuntu内核构建
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/08/linux/%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/ubuntu%E5%8F%91%E8%A1%8C%E7%89%88%E6%9C%AC/">
                     
										    ubuntu发行版本
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										网络协议
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/03/14/linux/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/perf%E6%8A%93%E5%8F%96%E6%94%B6%E5%8F%91%E5%8C%85%E6%B5%81%E7%A8%8B/">
                     
										    收发包流程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/tcp%E7%AA%97%E5%8F%A3%E6%9C%BA%E5%88%B6/">
                     
										    tcp窗口机制
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/linux/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/%E5%8D%8F%E8%AE%AE%E6%A0%88%E6%B5%81%E7%A8%8B/">
                     
										    协议栈流程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2018/12/17/linux/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/%E5%8D%8F%E8%AE%AE%E6%A0%88%E8%B0%83%E4%BC%98%E5%8C%96tx/">
                     
										    [译] Linux 网络栈监控和调优：发送数据（2017）
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										network
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										base_knowledge
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/09/20/network/base_knowledge/tun%20%E4%B8%8E%20tap%20%E8%AE%BE%E5%A4%87%EF%BC%8C%E7%BD%91%E6%A1%A5%E3%80%81VLAN%E3%80%81bonding%20%E7%9A%84%E5%AD%A6%E4%B9%A0/">
                     
										    linux内核网络设备
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2019/07/20/network/base_knowledge/%E7%BD%91%E5%8D%A1%20promiscuous%20mode%20%E4%B8%8E%20MAC%20%E7%9A%84%E4%B8%80%E4%BA%9B%20filter%20%E5%8A%9F%E8%83%BD/">
                     
										    linux内核网络设备
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										debug
									</a>
									
							<ul>
								<li class="file">
									<a href="/2020/11/01/network/debug/dropwatch_%E7%9B%91%E6%8E%A7%E5%86%85%E6%A0%B8%E7%9A%84%E7%BD%91%E7%BB%9C%E6%A0%88%E4%B8%A2%E5%8C%85/">
                     
										    dropwatch 监控内核的网络栈丢包
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										ethtool
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/03/network/ethtool/ethtool_dump_%E7%BD%91%E5%8D%A1%E5%AF%84%E5%AD%98%E5%99%A8/">
                     
										    ethtool 代码架构
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/11/04/network/ethtool/ethtool_%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/">
                     
										    ethtool_的工作原理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										kernel网络
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/09/07/network/kernel%E7%BD%91%E7%BB%9C/Linux%E7%BD%91%E5%8D%A1%E9%87%8D%E5%91%BD%E5%90%8D/">
                     
										    Linux 网卡重命名
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2019/09/07/network/kernel%E7%BD%91%E7%BB%9C/iproute2%E4%BD%BF%E7%94%A8--nat%E7%BD%91%E6%A1%A5%E9%85%8D%E7%BD%AE/">
                     
										    iproute2使用--nat网桥配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/11/18/network/kernel%E7%BD%91%E7%BB%9C/rss_rps_rfs/">
                     
										    Linux 网卡rss,rps,rfs
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/17/network/kernel%E7%BD%91%E7%BB%9C/%E5%86%85%E6%A0%B8%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0%E9%99%90%E9%80%9F/">
                     
										    内核日志打印限速
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/08/29/network/kernel%E7%BD%91%E7%BB%9C/%E5%8F%8C%E7%BD%91%E5%8D%A1%E7%9A%84bounding%E6%A8%A1%E5%BC%8F/">
                     
										    双网卡的bounding模式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/08/29/network/kernel%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E4%B8%A2%E5%8C%85%E6%95%85%E9%9A%9C%E5%AE%9A%E4%BD%8D%E5%85%A8%E6%99%AF%E6%8C%87%E5%8D%97/">
                     
										    网络丢包故障定位全景指南
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/17/network/kernel%E7%BD%91%E7%BB%9C/%E9%80%9A%E8%BF%87%E9%A9%B1%E5%8A%A8%E6%9D%A5%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAeth_device/">
                     
										    通过驱动来创建一个eth device
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/20/network/p4%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%B5%84%E6%BA%90%E4%BC%98%E5%8C%96%E6%8C%87%E5%8D%97/">
                     
										    p4程序的资源优化指南
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										rte_kni
									</a>
									
							<ul>
								<li class="file">
									<a href="/2022/09/07/network/rte_kni/dpdk%20kni%20%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3%E5%8E%9F%E7%90%86/">
                     
										    dpdk 程序kni 虚拟网络接口原理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/07/network/rte_kni/dpdk%20%E7%A8%8B%E5%BA%8F%E5%AF%B9pause%20%E5%B8%A7%E7%9A%84%E5%A4%84%E7%90%86/">
                     
										    dpdk 程序对pause 帧的处理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/09/07/network/rte_kni/%E9%80%9A%E8%BF%87slabinfo%E5%AE%9A%E4%BD%8D%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E9%97%AE%E9%A2%98/">
                     
										    dpdk 程序创建 kni 虚拟网络接口失败的问题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/08/29/network/%E5%B8%B8%E7%94%A8%E7%BD%91%E7%BB%9C%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5%E5%B7%A5%E5%85%B7/">
                     
										    常用网络故障排查工具
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										other
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/11/01/other/c%E8%AF%AD%E8%A8%80%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/">
                     
										    c语言-智能指针的用法
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/18/other/frpc%E6%9E%81%E7%AE%80%E9%83%A8%E7%BD%B2/">
                     
										    frpc极简部署
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/08/29/other/githubpage-vscocd-hexo%E6%9E%84%E5%BB%BA%E7%AC%94%E8%AE%B0%E5%8D%9A%E5%AE%A2/">
                     
										    githubpage+vscocd+hexo构建笔记博客
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										graphviz
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/12/21/other/graphviz/graphviz/">
                     
										    graphviz
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/05/24/other/graphviz/tips/">
                     
										    graphviz—tips
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/11/other/vscode_git_auto_push/">
                     
										    vscode-git-自动push
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/08/29/other/windows_treminal/">
                     
										    windows terminal技巧
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										pcie
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/pcie/dmar--root_table/">
                     
										    dmar--root_table
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/pcie/pasid/">
                     
										    pasid
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										qemu
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/IPI%E4%B8%AD%E6%96%AD%E6%80%A7%E8%83%BD%E8%AF%84%E4%BC%B0/">
                     
										    IPI中断性能评估
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/Kick_vcpu/">
                     
										    Kick_vcpu
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/21/qemu/dhcp%E6%9C%8D%E5%8A%A1%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/">
                     
										    为qemu运行快速部署dhcp服务
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/gust%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">
                     
										    gust内存管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/kvm/">
                     
										    kvm
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/qemu%20vhost_user%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E9%80%BB%E8%BE%91/">
                     
										    qemu vhost_user的初始化逻辑
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/20/qemu/qemu-kvm%E5%86%85%E5%AD%98%E8%99%9A%E6%8B%9F%E5%8C%96/">
                     
										    qemu-kvm 内存虚拟化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/20/qemu/qemu%E5%88%9D%E5%A7%8B%E5%8C%96/">
                     
										    qemu 初始化流程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/12/21/qemu/qemu%E5%90%8E%E7%AB%AF%E5%86%99%E6%B8%85%E9%99%A4%E6%9C%BA%E5%88%B6/">
                     
										    qemu后端写清除机制
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/07/21/qemu/qemu%E8%BF%90%E8%A1%8Cvirtio_net%E7%9A%84%E5%87%A0%E7%A7%8D%E6%A8%A1%E5%BC%8F/">
                     
										    qemu运行virtio_net的几种模式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/qom%E6%A8%A1%E5%9E%8B/">
                     
										    qom模型
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/vcpu%E8%BF%81%E7%A7%BB/">
                     
										    vcpu迁移
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/vmcs/">
                     
										    vmcs
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/qemu/%E4%B8%AD%E6%96%AD%E8%99%9A%E6%8B%9F%E5%8C%96/">
                     
										    中断虚拟化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										性能优化
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/09/24/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/cpu%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">
                     
										    cpu性能优化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/perf%E6%80%A7%E8%83%BD%E8%A7%82%E6%B5%8B/">
                     
										    perf性能观测
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%8F%AF%E8%A7%82%E6%B5%8B%E5%B7%A5%E5%85%B7/">
                     
										    可观测工具
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										硬件相关
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										dram
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/12/03/%E7%A1%AC%E4%BB%B6%E7%9B%B8%E5%85%B3/dram/DRAM%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/">
                     
										    DRAM基本工作原理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/08/29/%E7%A1%AC%E4%BB%B6%E7%9B%B8%E5%85%B3/pcie%20%E5%87%80%E8%BD%BD%E8%8D%B7%E8%BD%AC%E5%8F%91%E5%B8%A6%E5%AE%BD/">
                     
										    pcie 净载荷转发带宽
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										pcie
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/03/23/%E7%A1%AC%E4%BB%B6%E7%9B%B8%E5%85%B3/pcie/PCIe%20ECAM%E4%BB%8B%E7%BB%8D/">
                     
										    PCIe ECAM介绍
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/%E7%A1%AC%E4%BB%B6%E7%9B%B8%E5%85%B3/pcie/tlp/">
                     
										    tlp
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/08/29/%E7%A1%AC%E4%BB%B6%E7%9B%B8%E5%85%B3/rmii/">
                     
										    rmii
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/06/29/%E7%A1%AC%E4%BB%B6%E7%9B%B8%E5%85%B3/serders%E5%8E%9F%E7%90%86/">
                     
										    serder
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										虚拟化
									</a>
									
							<ul>
								<li class="file">
									<a href="/2023/09/20/%E8%99%9A%E6%8B%9F%E5%8C%96/pcie_%E8%99%9A%E6%8B%9F%E5%8C%96/">
                     
										    pcie 入门
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2023/09/20/%E8%99%9A%E6%8B%9F%E5%8C%96/vdpa/">
                     
										    vdpa代码逻辑
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/07/23/%E8%99%9A%E6%8B%9F%E5%8C%96/virtio/">
                     
										    virtio 协议
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/%E8%99%9A%E6%8B%9F%E5%8C%96/virtio_pci/">
                     
										    virtio_pci
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/%E8%99%9A%E6%8B%9F%E5%8C%96/%E4%B8%AD%E6%96%AD%E8%99%9A%E6%8B%9F%E5%8C%96/">
                     
										    中断虚拟化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/12/03/%E8%99%9A%E6%8B%9F%E5%8C%96/%E5%86%85%E6%A0%B8%E7%9A%84vdpa%E6%96%B9%E6%A1%88/">
                     
										    内核的vdpa方案
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/03/20/%E8%99%9A%E6%8B%9F%E5%8C%96/%E7%83%AD%E8%BF%81%E7%A7%BB%E4%BB%A3%E7%A0%81%E9%80%BB%E8%BE%91/">
                     
										    热迁移代码逻辑
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										热迁移
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/03/20/%E8%99%9A%E6%8B%9F%E5%8C%96/%E7%83%AD%E8%BF%81%E7%A7%BB/0-%E6%80%BB%E4%BD%93%E4%BB%8B%E7%BB%8D/">
                     
										    热迁移代码逻辑
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/20/%E8%99%9A%E6%8B%9F%E5%8C%96/%E7%83%AD%E8%BF%81%E7%A7%BB/1-%E5%86%85%E5%AD%98%E7%83%AD%E8%BF%81%E7%A7%BB/">
                     
										    内存热迁移
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/20/%E8%99%9A%E6%8B%9F%E5%8C%96/%E7%83%AD%E8%BF%81%E7%A7%BB/1.1-%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95/">
                     
										    内存热迁移-基础用法
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/20/%E8%99%9A%E6%8B%9F%E5%8C%96/%E7%83%AD%E8%BF%81%E7%A7%BB/1.2-%E8%84%8F%E9%A1%B5%E6%A0%87%E8%AE%B0/">
                     
										    内存热迁移-脏页标记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/20/%E8%99%9A%E6%8B%9F%E5%8C%96/%E7%83%AD%E8%BF%81%E7%A7%BB/2-%E8%AE%BE%E5%A4%87%E7%83%AD%E8%BF%81%E7%A7%BB/">
                     
										    设备热迁移
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2024/04/20/%E8%99%9A%E6%8B%9F%E5%8C%96/%E7%83%AD%E8%BF%81%E7%A7%BB/%E8%AE%BE%E5%A4%87%E7%83%AD%E8%BF%81%E7%A7%BBqemu%E4%B8%8Edpdk%E9%80%9A%E8%BF%87vhost_user%E7%9A%84%E4%BA%A4%E4%BA%92%E6%B5%81%E7%A8%8B/">
                     
										    设备热迁移qemu与dpdk通过vhost_user的交互流程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										读书笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/11/18/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E5%BA%B7%E5%BE%B7/">
                     
										    纯粹理性批判
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										软件开发
									</a>
									
							<ul>
								<li class="file">
									<a href="/2024/07/11/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/gdb/">
                     
										    常用调试方法
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2022/10/01/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/github_action/">
                     
										    github action使用介绍
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2020/11/01/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/git%E5%B8%B8%E7%94%A8/">
                     
										    git 常用命令
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>



	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	linux_udev机制实现-1
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>liaocj</span>
	<span>2022-09-20 16:04:03</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
          
              <span>
                  <i class="fa fa-folder" aria-hidden="true">
                  <a href="/categories/linux/">linux</a>
                  </i>
                
                  >
                
              </span>
          
      
          
              <span>
                  <i class="fa fa-folder" aria-hidden="true">
                  <a href="/categories/linux/网络开发/">网络开发</a>
                  </i>
                
                  >
                
              </span>
          
      
          
              <span>
                  <i class="fa fa-folder" aria-hidden="true">
                  <a href="/categories/linux/网络开发/驱动/">驱动</a>
                  </i>
                
                  >
                
              </span>
          
      
          
              <span>
                  <i class="fa fa-folder" aria-hidden="true">
                  <a href="/categories/linux/网络开发/驱动/udev/">udev</a>
                  </i>
                
              </span>
          
      
    

    
		    <span>Tags：</span>
        
            
                <span>
                    <i class="fa fa-tag" aria-hidden="true">
                    <a href="/tags/kernel/">kernel</a>
                    </i>
                </span>
            
        
            
                <span>
                    <i class="fa fa-tag" aria-hidden="true">
                    <a href="/tags/netlink/">netlink</a>
                    </i>
                </span>
            
        
            
                <span>
                    <i class="fa fa-tag" aria-hidden="true">
                    <a href="/tags/linux驱动/">linux驱动</a>
                    </i>
                </span>
            
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<h2 id="linux-udev-机制实现-1-规则文件"><a href="#linux-udev-机制实现-1-规则文件" class="headerlink" title="linux udev 机制实现-1-规则文件"></a>linux udev 机制实现-1-规则文件</h2><p>在上一章中对 udev 的执行机制以及 udev 的规则文件做了一个简要的介绍，在这一章节，则着重将焦点放在如何编写规则文件上，毕竟，这才是系统管理员最常用到的知识点。</p>
<h2 id="udev-规则"><a href="#udev-规则" class="headerlink" title="udev 规则"></a>udev 规则</h2><p>正如前文中所说，规则文件通常以 .rules 结尾，实际上，规则文件并本身没有太多的意义，最重要的是规则文件中的规则，而 udevd 守护进程也是逐条地去匹配规则，而规则文件主要作用就是对规则进行组织，方便管理。</p>
<p>udev 的规则遵循以下的原则：</p>
<ul>
<li>每条规则必须只占一行，可以使用 \ 来连接编辑器中的多行，这和宏定义是相似的</li>
<li>每条规则分为两部分：match(匹配) 和 action(执行动作)，这其实很好理解，match 的作用在于确定当前规则是否适用，匹配成功也就是当前规则适用于当前设备时，再执行相应的动作，即 action。每一部分存在一个或多个条目，以逗号分隔。</li>
<li>规则中的条目主要分为三个部分：key、operator、value，key 是键，也可以理解为关键字，operator 是操作符，而 value 是值。比如 SUBSYSTEM&#x3D;&#x3D;”foo”。</li>
</ul>
<p>对于每一条规则来说，match 和 action 没有特定的区分标志，而是通过 operator(操作符) 进行区分，在大部分的编程语言中，”&#x3D;&#x3D;” 表示逻辑判断，而 “&#x3D;” 或 “+&#x3D;” 之类的属于赋值，所以使用 “&#x3D;&#x3D;” 或者 “!&#x3D;” 这种逻辑判断操作符的就是 match 类的条目，而使用赋值类操作符的就是 action 部分。</p>
<p>规则中的每个条目中的键用于匹配或者作为关键字被赋值，一个非常重要的问题就是：它是怎么来的，我们怎么知道它的值是多少？只有知道它的由来，才能针对性地编写对应的规则。</p>
<p>实际上，我们可以把所有的键看成是 udev 的关键字。</p>
<p>一方面，从内核发送到用户空间的信息通常是这样的(以 RTC 为例)：</p>
<pre class="line-numbers language-none"><code class="language-none">change@&#x2F;devices&#x2F;platform&#x2F;ocp&#x2F;44e3e000.rtc&#x2F;rtc&#x2F;rtc0&#x2F;omap_rtc_scratch0 ACTION&#x3D;change DEVPATH&#x3D;&#x2F;devices&#x2F;platform&#x2F;ocp&#x2F;44e3e000.rtc&#x2F;rtc&#x2F;rtc0 omap_rtc_scratch0 SUBSYSTEM&#x3D;nvmemSYNTH_UUID&#x3D;0SEQNUM&#x3D;4266<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这是 beaglebone 平台上触发 rtc 时从内核发送到用户空间的设备信息,在内核信息中，DEVPATH、SUBSYSTEM、SYNTH_UUID 会被自动添加为关键字。</p>
<p>另一方面，udevd 默认提供了许多关键字，比如 SYMLINK 表示软链接，RUN 表示需要执行的程序，同时用户也可以自定义关键字，直接使用 KEY&#x3D;”foo” 就可以定义一个 KEY 关键字。</p>
<p>看看下面这一条规则示例：</p>
<pre class="line-numbers language-none"><code class="language-none">SUBSYSTEM&#x3D;&#x3D;&quot;rtc&quot;, KERNEL&#x3D;&#x3D;&quot;rtc0&quot;, SYMLINK+&#x3D;&quot;rtc&quot;, OPTIONS+&#x3D;&quot;link_priority&#x3D;-100&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这是 50-udev-default.rules 中一条针对 rtc 设备的规则，其中：</p>
<pre class="line-numbers language-none"><code class="language-none">SUBSYSTEM&#x3D;&#x3D;&quot;rtc&quot;, KERNEL&#x3D;&#x3D;&quot;rtc0&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这是规则中的 match 部分，判断当前内核设备消息的 SUBSYSTEM 是否为 “rtc”，同时判断 KERNEL(设备内核名) 是否为 “rtc0”，如果两者都满足条件，则执行后面的 action 部分：</p>
<pre class="line-numbers language-none"><code class="language-none">SYMLINK+&#x3D;&quot;rtc&quot;, OPTIONS+&#x3D;&quot;link_priority&#x3D;-100&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>第一条 action 条目为 SYMLINK+&#x3D;”rtc”，表示为设备 rtc0 创建一个软链接，名为 rtc，同时设置 OPTION 属性，这个属性将会在其它地方被使用到。</p>
<p>在你的 linux 系统上，你可以通过 ls -l &#x2F;dev&#x2F;rtc* 来查看系统中的 rtc 相关信息,通常是这样的：</p>
<pre class="line-numbers language-none"><code class="language-none">lrwxrwxrwx ... &#x2F;dev&#x2F;rtc -&gt; rtc0
crw------- ... &#x2F;dev&#x2F;rtc0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>如果你没有手动地更改系统 rtc 设置，可以看到，&#x2F;dev&#x2F;rtc 是指向 &#x2F;dev&#x2F;rtc0 的软链接，这个软链接的创建正是由上述的规则所创建，而 &#x2F;dev&#x2F;rtc0 则是由内核默认创建的。</p>
<h2 id="udev-规则文件的编写"><a href="#udev-规则文件的编写" class="headerlink" title="udev 规则文件的编写"></a>udev 规则文件的编写</h2><h3 id="udev-操作符"><a href="#udev-操作符" class="headerlink" title="udev 操作符"></a>udev 操作符</h3><p>在 udev 中，支持的操作符有：</p>
<ul>
<li>“&#x3D;&#x3D;” : 用于 match(匹配)，用于判断相等。</li>
<li>“!&#x3D;” : 用于 match，用于判断不等于</li>
<li>“&#x3D;”  : 用于 action ，表示赋值</li>
<li>“-&#x3D;” : 用于 action ，表示从值列表中删除指定的值</li>
<li>“+&#x3D;” ：用于 action，表示将新值附加到值列表中</li>
<li>“:&#x3D;” ：用于 action，表示绝对赋值，即该操作指定的值就是最终值，禁止后续再进行修改。</li>
</ul>
<h3 id="udev-关键字"><a href="#udev-关键字" class="headerlink" title="udev 关键字"></a>udev 关键字</h3><p>udev 定义了多个关键字，这些关键字用于匹配或者赋值，在实际的 udev 匹配过程中，还支持针对父级设备进行匹配，而不仅仅是生成设备事件的设备自身，linux 中大量的设备由各类总线进行连接，形成树状的设备拓扑结构，所以在新内核中使用设备树在软件上对所有设备进行描述，而总线本身也被视为设备的一种，父子设备之间通常具有强相关性，因此针对父级(或者祖父级)进行模糊地匹配是合理的。</p>
<h3 id="udev-匹配关键字"><a href="#udev-匹配关键字" class="headerlink" title="udev 匹配关键字"></a>udev 匹配关键字</h3><h4 id="ACTION"><a href="#ACTION" class="headerlink" title="ACTION"></a>ACTION</h4><p>设备事件的操作类型，有以下几种：</p>
<ul>
<li>KOBJ_ADD：添加设备</li>
<li>KOBJ_REMOVE：移除设备</li>
<li>KOBJ_CHANGE：设备变动</li>
<li>KOBJ_MOVE：移动设备</li>
<li>KOBJ_ONLINE：设备上线</li>
<li>KOBJ_OFFLINE：设备离线</li>
<li>KOBJ_BIND：设备绑定</li>
<li>KOBJ_UNBIND：设备解绑</li>
</ul>
<p>在内核中使用一个枚举结构来定义设备操作类型：</p>
<pre class="line-numbers language-none"><code class="language-none">enum kobject_action &#123;
    KOBJ_ADD,
    KOBJ_REMOVE,
    KOBJ_CHANGE,
    KOBJ_MOVE,
    KOBJ_ONLINE,
    KOBJ_OFFLINE,
    KOBJ_BIND,
    KOBJ_UNBIND,
    KOBJ_MAX
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>其中，KOBJ_MAX 表示设备支持操作的最大值，用于判断指定的设备操作是否超出限制。</p>
<h4 id="DEVPATH"><a href="#DEVPATH" class="headerlink" title="DEVPATH"></a>DEVPATH</h4><p>设备对应的路径，该关键字以及对应的值通常包含在内核传递给用户空间的 netlink 消息中。</p>
<h4 id="KERNEL"><a href="#KERNEL" class="headerlink" title="KERNEL"></a>KERNEL</h4><p>设备在内核中的名称，内核名称是指设备在sysfs里的名称，也就是默认的设备文件名称，例如”sda”,这个值通常不包含在 netlink 消息中。</p>
<h4 id="NAME"><a href="#NAME" class="headerlink" title="NAME"></a>NAME</h4><p>匹配网络接口的名称。仅在先前的规则中已将 NAME 键赋值的前提下，才可将此键用于匹配，也就是默认情况下，NAME 不会被自动赋值。</p>
<h4 id="SYMLINK"><a href="#SYMLINK" class="headerlink" title="SYMLINK"></a>SYMLINK</h4><p>匹配指向此设备节点的软连接的名称。 仅在先前的规则中已将 SYMLINK 键赋值的前提下，才可将此键用于匹配。 可能有多个软连接指向同一个设备节点，但只需其中的一个匹配成功即可。</p>
<h4 id="SUBSYSTEM"><a href="#SUBSYSTEM" class="headerlink" title="SUBSYSTEM"></a>SUBSYSTEM</h4><p>匹配设备所属的子系统，该关键字以及对应的值通常包含在内核传递给用户空间的 netlink 消息中。</p>
<h4 id="DRIVER"><a href="#DRIVER" class="headerlink" title="DRIVER"></a>DRIVER</h4><p>匹配设备的驱动程序名称。仅在设备事件发生时，此设备确实正好绑定着一个驱动程序情况下，此键才会被设置。因此 netlink 消息中只是可能存在该关键字。</p>
<h4 id="ATTR-file"><a href="#ATTR-file" class="headerlink" title="ATTR{file}"></a>ATTR{file}</h4><p>匹配设备在sysfs中的属性值。属性值中的尾部空白会被忽略，除非指定的值自身就包含尾部空白。大括号中的”文件”是指设备路径(devpath)下的文件。 例如，对于 &#x2F;dev&#x2F;sda1 来说，ATTR{size} 的含义其实是指 &#x2F;sys&#x2F;block&#x2F;sda&#x2F;sda1&#x2F;size 文件的内容。</p>
<h4 id="SYSCTL-kern-param"><a href="#SYSCTL-kern-param" class="headerlink" title="SYSCTL{kern_param}"></a>SYSCTL{kern_param}</h4><p>匹配”内核参数”的值。所谓”内核参数”其实是指 &#x2F;proc&#x2F;sys&#x2F; 中的”内核参数”。例如，可以用 SYSCTL{kernel&#x2F;hostname} 匹配 &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;hostname 的值。</p>
<h4 id="ENV-attr"><a href="#ENV-attr" class="headerlink" title="ENV{attr}"></a>ENV{attr}</h4><p>设备属性，这些属性是由规则文件或者 udevd 程序中定义的，比如 “DEVTYPE”, “ID_PATH”, “SYSTEMD_WANTS” 等等，相当于环境变量。</p>
<h4 id="PROGRAM"><a href="#PROGRAM" class="headerlink" title="PROGRAM"></a>PROGRAM</h4><p>执行指定的程序并检查返回值， 如果返回值为零，则匹配成功，否则匹配失败。 设备的属性会转化为该程序的环境变量供其使用。 同时该程序的标准输出会被 自动保存在 RESULT 键中。</p>
<p>注意，仅可用于执行时间很短的前台程序。</p>
<h4 id="RESULT"><a href="#RESULT" class="headerlink" title="RESULT"></a>RESULT</h4><p>匹配最近一次 PROGRAM 程序的输出字符串， 必须位于 PROGRAM 之后(但可出现在同一条规则中)。</p>
<h4 id="TAG"><a href="#TAG" class="headerlink" title="TAG"></a>TAG</h4><p>匹配设备的标签，udev 规则中可以为设备指定标签。</p>
<p>上述的关键字中，同时存在多种带后缀 “S” 的版本，即 “KERNELS”,”SUBSYSTEMS”,”DRIVERS”,”ATTRS”,”TAGS”等(具体参考<a target="_blank" rel="noopener" href="https://www.freedesktop.org/software/systemd/man/udev.html#">官方文档</a>)，这些带后缀 S 的关键字和不带 S 的实现同样的功能，唯一的区别在于：带后缀 “S” 的关键字可以针对父级进行匹配，比如 KERNELS&#x3D;”foo”，只要当前设备的任一级父级设备满足该条件，即匹配成功。</p>
<h3 id="统配符"><a href="#统配符" class="headerlink" title="统配符"></a>统配符</h3><p>udev 的匹配规则中支持统配符的使用：</p>
<h4 id="“-”"><a href="#“-”" class="headerlink" title="“*”"></a>“*”</h4><p>匹配任意数量的字符(包括零个)</p>
<h4 id="“-”-1"><a href="#“-”-1" class="headerlink" title="“?”"></a>“?”</h4><p>匹配单独一个字符</p>
<h4 id="“-”-2"><a href="#“-”-2" class="headerlink" title="“[]”"></a>“[]”</h4><p>匹配中括号内的任意一个字符。 例如 “tty[SR]” 可以匹配 “ttyS” 或 “ttyR” 。 还可以使用 “-“ 符号表示一个区间。 例如 “[0-9]” 可以匹配任意数字。 如果在左括号 “[“ 后紧接着一个 “!” 则表示匹配非括号内的字符。</p>
<h4 id="“-”-3"><a href="#“-”-3" class="headerlink" title="“|”"></a>“|”</h4><p>用于分隔两个可相互替代的匹配模式(也就是”或”的意思)。 例如 “abc|x*” 的意思是匹配 “abc” 或 “x*”</p>
<hr>
<h3 id="udev-赋值关键字"><a href="#udev-赋值关键字" class="headerlink" title="udev 赋值关键字"></a>udev 赋值关键字</h3><h4 id="NAME-1"><a href="#NAME-1" class="headerlink" title="NAME"></a>NAME</h4><p>设置网络接口的名称。实际上，udev 并不能直接修改设备节点的名称， 它只能为设备节点创建额外的符号链接(相当于添加了别名)。</p>
<h4 id="SYMLINK-1"><a href="#SYMLINK-1" class="headerlink" title="SYMLINK"></a>SYMLINK</h4><p>设置指向此设备节点的 软连接名称。</p>
<p>只需在多个名称之间使用空格分隔，即可一次指定多个软连接名称。 如果为多个不同的设备指定了相同的软连接， 那么实际的软连接将指向 link_priority 值最高的设备。 如果 link_priority 值最高的设备被移除， 那么该软连接将重新指向下一个 link_priority 值最高的设备，以此类推。 对于未指定 link_priority 值或者 link_priority 值相等的设备， 它们之间的顺序是不确定的。</p>
<p>符号连接的名称必须不能与内核的默认名称相同， 否则会得到无法预知的结果。</p>
<h4 id="OWNER-GROUP-MODE"><a href="#OWNER-GROUP-MODE" class="headerlink" title="OWNER, GROUP, MODE"></a>OWNER, GROUP, MODE</h4><p>设置设备节点的属主、属组、权限。会覆盖内置的默认值。</p>
<h4 id="ATTR-filename"><a href="#ATTR-filename" class="headerlink" title="ATTR{filename}"></a>ATTR{filename}</h4><p>设置在sysfs中的设备属性。大括号中的”文件”是指设备路径(devpath)下的文件。 例如，对于 &#x2F;dev&#x2F;sda1 来说，ATTR{size} 的含义其实是指 &#x2F;sys&#x2F;block&#x2F;sda&#x2F;sda1&#x2F;size 文件的内容。</p>
<h4 id="ENV-attr-1"><a href="#ENV-attr-1" class="headerlink" title="ENV{attr}"></a>ENV{attr}</h4><p>设置设备的属性。例如 “DEVTYPE”, “ID_PATH”, “SYSTEMD_WANTS” 等等。可以通过 udevadm info –query&#x3D;property &#x2F;dev&#x2F;sda 命令查看 &#x2F;dev&#x2F;sda 的所有属性。 如果属性名以 “.” 开头，那么此属性将不会被记录到udev数据库中，也不会被导出为环境变量(例如 PROGRAM)。</p>
<h4 id="TAG-1"><a href="#TAG-1" class="headerlink" title="TAG"></a>TAG</h4><p>设置设备的标签。 用于为libudev监视(monitor)功能的用户过滤事件或者枚举已标记的设备。 标签仅在与特殊的设备过滤器一起使用时才有意义，千万不要用于常规目的。 滥用标签将会导致设备事件处理效率显著下降， 所以应该尽量避免为设备设置标签。</p>
<h4 id="RUN-type"><a href="#RUN-type" class="headerlink" title="RUN{type}"></a>RUN{type}</h4><p>对于每一个设备事件来说，在处理完所有udev规则之后， 都可以再接着执行一个由此键设置的程序列表(默认为空)。 不同的”类型”含义如下：</p>
<ul>
<li><p>“program”<br>  一个外部程序， 如果是相对路径， 那么视为相对于 &#x2F;usr&#x2F;lib&#x2F;udev 目录。 否则必须使用绝对路径。</p>
<p>  如果未明确指定”类型”， 那么这是默认值。</p>
</li>
<li><p>“builtin”<br>  与 program 类似， 但是仅用于表示内置的程序。</p>
<p>  程序名与其参数之间用空格分隔。 如果参数中含有空格，那么必须使用单引号(‘)界定。</p>
<p>  仅可使用运行时间非常短的前台程序， 切勿设置任何 后台守护进程或者长时间运行的程序。</p>
<p>  设备事件处理完成之后， 所有派生的进程(无论是否已经分离)， 都将会被无条件的杀死。</p>
<p>  注意，禁止在 udev 规则中运行访问网络、或挂载&#x2F;卸载文件系统的程序， 因为在 systemd-udevd.service 中强制使用了默认沙盒机制。</p>
</li>
</ul>
<h4 id="LABEL"><a href="#LABEL" class="headerlink" title="LABEL"></a>LABEL</h4><p>设置一个可用作 GOTO 跳转目标的标签。</p>
<h4 id="GOTO"><a href="#GOTO" class="headerlink" title="GOTO"></a>GOTO</h4><p>跳转到下一个匹配的 LABEL 标签所在的规则。</p>
<h4 id="IMPORT-type"><a href="#IMPORT-type" class="headerlink" title="IMPORT{type}"></a>IMPORT{type}</h4><p>将一组变量导入为设备的属性。不同的”类型”含义如下：</p>
<ul>
<li><p>“program”<br>  执行一个外部程序， 并且当其返回值为零时导入其输出内容。 注意，输出内容的每一行都必须符合”key&#x3D;value”格式。 关于程序路径、命令与参数分隔符、引号的使用规则、程序执行时间，等等， 都与 RUN 相同。</p>
</li>
<li><p>“builtin”<br>  与 “program” 类似， 但是仅用于执行内置的程序。</p>
</li>
<li><p>“file”<br>  导入一个文本文件的内容。该文本文件的每一行都必须符合”key&#x3D;value”格式。 以”#”开头的行将被视为注释而忽略。</p>
</li>
<li><p>“db”<br>  从当前已有的udev数据库中导入一个单独的属性。 仅可用于udev数据库确实 已经被早先的设备事件所填充的情形。</p>
</li>
<li><p>“cmdline”<br>  从内核引导选项导入一个单独的属性。对于那些仅有单独的标记而没有值的属性， 其值将被指定为 “1” 。</p>
</li>
<li><p>“parent”<br>  从父设备导入已有的属性(包括对应的值)。 可以将 IMPORT{parent} 赋值为shell风格的匹配模式， 以导入 多个属性名称与匹配模式相符的属性。</p>
<p>  仅可使用运行时间非常短的前台程序，切勿设置任何后台守护进程或者长时间运行的程序。</p>
</li>
</ul>
<h4 id="OPTIONS"><a href="#OPTIONS" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><p>规则与设备的选项：</p>
<ul>
<li><p>link_priority&#x3D;value<br>  指定创建符号链接时的优先级。 数值越大优先级越高。默认值是”0”。</p>
</li>
<li><p>string_escape&#x3D;none|replace<br>  在对设备进行命名时，如何处理设备名字中的非常规字符(比如控制字符与不安全的字符)。 none 表示不做处理，保持原样； replace 表示将这些非常规字符替换为”_”(下划线)。</p>
</li>
<li><p>static_node&#x3D;<br>  将本条规则设定的权限 应用到此选项指定的静态设备节点上。 同时，如果在本规则中指定了标签(tag)， 那么还会在 &#x2F;run&#x2F;udev&#x2F;static_node-tags&#x2F;tag 目录中创建一个指向该静态设备节点的软连接。 注意，在 systemd-udevd 启动之前， 静态设备节点就已经由 systemd-tmpfiles 创建完成了。 创建静态设备节点时，并不要求存在对应的内核设备， 因为当这些设备节点被访问时，会触发内核模块的自动加载功能。</p>
</li>
<li><p>watch<br>  使用文件系统的 inotify 功能监视设备节点。 当节点被打开并写入之后又被关闭， 将会触发一个”设备状态已变化”的事件。</p>
</li>
<li><p>nowatch<br>  禁用针对设备节点的 inotify 监视功能。</p>
</li>
<li><p>db_persist<br>  在事件设备的 udev 数据库项上设置 粘滞位(sticky bit)。 这样，即使调用了 udevadm info –cleanup-db 命令， 设备的属性也依然会保存在数据库中。 在某些情况下(例如 Device Mapper 设备)， 此选项可用于从 initramfs 切换至真实的根文件系统时，依然保持设备的状态。</p>
</li>
</ul>
<h3 id="字符替换"><a href="#字符替换" class="headerlink" title="字符替换"></a>字符替换</h3><p>NAME, SYMLINK, PROGRAM, OWNER, GROUP, MODE, SECLABEL, RUN 都支持简单的字符串替换。 RUN 的替换发生在 所有规则全部处理完成之后、程序将要执行之前， 因此可以使用由匹配成功的规则所设置的设备属性。 而其他键的替换发生在该键所在规则被处理完成的当时。 可用的替换标记如下：</p>
<h4 id="kernel-k"><a href="#kernel-k" class="headerlink" title="$kernel, %k"></a>$kernel, %k</h4><p>设备的内核名称</p>
<h4 id="number-n"><a href="#number-n" class="headerlink" title="$number, %n"></a>$number, %n</h4><p>设备在内核中的序号。例如，对于 “sda3” 来说，此值为 “3”</p>
<h4 id="devpath-p"><a href="#devpath-p" class="headerlink" title="$devpath, %p"></a>$devpath, %p</h4><p>设备路径(devpath)。也就是该设备在sysfs文件系统下的相对路径。例如，&#x2F;dev&#x2F;sda1 对应的设备路径是 &#x2F;block&#x2F;sda&#x2F;sda1 (一般对应着 &#x2F;sys&#x2F;block&#x2F;sda&#x2F;sda1 目录)。</p>
<h4 id="id-b"><a href="#id-b" class="headerlink" title="$id, %b"></a>$id, %b</h4><p>被 SUBSYSTEMS, KERNELS, DRIVERS, ATTRS 成功匹配到的设备的设备名称</p>
<h4 id="driver"><a href="#driver" class="headerlink" title="$driver"></a>$driver</h4><p>被 SUBSYSTEMS, KERNELS, DRIVERS, ATTRS 成功匹配到的设备的驱动名称</p>
<h4 id="attr-文件-s-文件"><a href="#attr-文件-s-文件" class="headerlink" title="$attr{文件}, %s{文件}"></a>$attr{文件}, %s{文件}</h4><p>在规则匹配成功时， 设备路径(devpath)下”文件”的内容(用于表示设备的属性)。 如果该设备路径下没有此文件，则从先前 KERNELS, SUBSYSTEMS, DRIVERS, ATTRS 匹配的父设备中提取。</p>
<p>如果”文件”是一个软连接， 则一直追踪软连接到最终的实际文件。</p>
<h4 id="env-属性-E-属性"><a href="#env-属性-E-属性" class="headerlink" title="$env{属性}, %E{属性}"></a>$env{属性}, %E{属性}</h4><p>设备的属性值。例如 “DEVTYPE”, “ID_PATH”, “SYSTEMD_WANTS” 等等。[提示]可以通过 udevadm info –query&#x3D;property &#x2F;dev&#x2F;sda 命令查看 &#x2F;dev&#x2F;sda 的所有属性。</p>
<h4 id="major-M"><a href="#major-M" class="headerlink" title="$major, %M"></a>$major, %M</h4><p>设备的主设备号</p>
<h4 id="minor-m"><a href="#minor-m" class="headerlink" title="$minor, %m"></a>$minor, %m</h4><p>设备的次设备号</p>
<h4 id="result-c"><a href="#result-c" class="headerlink" title="$result, %c"></a>$result, %c</h4><p>外部程序 PROGRAM 的输出字符串。 可以使用 “%c{N}” 提取第N个子字符串(以空格为分隔符，从”1”开始计数)。 也可以通过 “%c{N+}”(也就是在数字后附加一个 “+”)提取 从第N个子字符串开始一直到结尾的部分。</p>
<h4 id="parent-P"><a href="#parent-P" class="headerlink" title="$parent, %P"></a>$parent, %P</h4><p>父设备的节点名称</p>
<h4 id="name"><a href="#name" class="headerlink" title="$name"></a>$name</h4><p>设备的当前名称。如果没有被任何udev规则修改， 那么等于该设备的内核名称。</p>
<h4 id="links"><a href="#links" class="headerlink" title="$links"></a>$links</h4><p>一个空格分隔的软链接名称列表，这些软链接都指向该设备的节点。 该值仅在两种情况下存在：(1)发生”remove”事件；(2)先前的规则已对 SYMLINK 赋值。</p>
<h4 id="root-r"><a href="#root-r" class="headerlink" title="$root, %r"></a>$root, %r</h4><p>udev_root 的值</p>
<h4 id="sys-S"><a href="#sys-S" class="headerlink" title="$sys, %S"></a>$sys, %S</h4><p>sysfs 文件系统的挂载点</p>
<h4 id="devnode-N"><a href="#devnode-N" class="headerlink" title="$devnode, %N"></a>$devnode, %N</h4><p>设备节点的名称(也就是设备文件的名称)</p>
<h4 id=""><a href="#" class="headerlink" title="%%"></a>%%</h4><p>百分号 “%” 自身</p>
<h4 id="-1"><a href="#-1" class="headerlink" title="$$"></a>$$</h4><p>美元符号 “$” 自身</p>
<p>尽管规则只能被写作一行，并不代表设备的匹配只能使用一行，udev 也可以通过条规则来处理一个设备事件，比如第二条依赖于第一条的执行结果，以实现更灵活的配置，自然地，也就出现了很多赋值关键字和匹配关键字相同的情况。</p>
<p>比如，当系统中增加了一个 rtc 设备时，匹配到的第一条规则读取相应的信息，比如 &#x2F;sys 目录下的文件、内核传递的信息等，然后把某个有用的信息赋值给某个关键字，在后续的规则中，通过判断该关键字的值再执行其它的逻辑，udev 中这种做法很常见。</p>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/linux_udev%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-2/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  linux_udev机制实现-2
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2022/09/20/linux/%E5%86%85%E6%A0%B8-%E9%A9%B1%E5%8A%A8/udev/linux_udev%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-3/">
                linux_udev机制实现-3
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">liaocj</a>
	

	
	<br>
	Theme <a href="//github.com/sisyphus1212" target="_blank">Tree</a>
	by <a href="//space.bilibili.com/228776952" target="_blank">liaocj</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

    <script src='https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js'></script>
    <script>
      if (window.mermaid) {
        mermaid.initialize({theme: 'forest'});
      }
    </script>




<script src='https://cdnjs.cloudflare.com/ajax/libs/viz.js/1.7.1/viz.js'></script>
<script>
  String.prototype.replaceAll = function(search, replacement) {
	var target = this;
	return target.split(search).join(replacement);
  };
  let vizObjects = document.querySelectorAll('.graphviz')
  for (let item of vizObjects) {
	let svg = undefined
	try {
	  svg = Viz(item.textContent.replaceAll('–', '--'), 'svg')
	} catch(e) {
	  svg = `<pre class="error">${e}</pre>`
	}
	item.outerHTML = svg
  }
</script>

<!-- D3.js -->
<script src="https://d3js.org/d3.v6.min.js"></script>

<script>
(function(d3) {
    function initializeZoom(d3, svgElement) {
        if (!svgElement) {
            console.error('SVG element not found or passed incorrectly.');
            return;
        }

        const zoomBehavior = d3.zoom()
            .on('zoom', (event) => {
                d3.select(svgElement).select('g').attr("transform", event.transform);
            });

        d3.select(svgElement).call(zoomBehavior).on("dblclick.zoom", null);
        console.log('Zoom initialized on:', svgElement);
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Select the svg that contains #graph0 by using closest to find the parent SVG of #graph0
        const graph0 = document.querySelector('#graph0');
        if (graph0) {
            const svgElement = graph0.closest('svg'); // Find the closest svg ancestor
            if (svgElement) {
                initializeZoom(d3, svgElement);
            } else {
                console.error('No SVG element found containing #graph0');
            }
        } else {
            console.error('Element with id #graph0 not found.');
        }
    });
})(window.d3);
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>